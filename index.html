<!doctype html>
<html lang="hi">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Priyanka — Private Love Assistant (Secure)</title>
<style>
  :root{
    --bg1:#041225; --card:#071428; --accent1:#ff6bcb; --accent2:#8b5cf6; --accent3:#60a5fa; --muted:#9aa7bd;
    --radius:14px;
  }
  html,body{height:100%;margin:0;font-family:system-ui,Inter,Arial;background:linear-gradient(180deg,#041021 0%, #081427 100%);color:#eef7ff;-webkit-font-smoothing:antialiased;}
  .wrap{max-width:980px;margin:18px auto;padding:14px;}
  header{display:flex;align-items:center;justify-content:space-between;margin-bottom:12px;gap:12px;}
  .brand{display:flex;gap:12px;align-items:center;}
  .logo{width:52px;height:52px;border-radius:12px;display:flex;align-items:center;justify-content:center;background:linear-gradient(135deg,var(--accent1),var(--accent2));font-weight:700;font-size:20px;}
  h1{margin:0;font-size:18px;}
  .subtitle{color:var(--muted);font-size:13px;}
  .card{background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));border-radius:var(--radius);padding:12px;border:1px solid rgba(255,255,255,0.03);box-shadow:0 8px 26px rgba(2,6,23,0.6);transition:transform .22s,opacity .2s;}
  .grid{display:grid;grid-template-columns:1fr;gap:12px;margin-top:12px;}
  @media(min-width:900px){.grid{grid-template-columns:1fr 1fr;}}
  .cardHeader{display:flex;align-items:center;justify-content:space-between;gap:8px;}
  .title{display:flex;gap:10px;align-items:center;}
  .title h2{margin:0;font-size:15px;}
  .muted{color:var(--muted);font-size:13px;}
  .controls{display:flex;gap:8px;align-items:center;}
  .btn{background:transparent;border:1px solid rgba(255,255,255,0.04);padding:8px 10px;border-radius:10px;color:var(--muted);font-size:13px;}
  .iconBtn{background:linear-gradient(90deg,var(--accent1),var(--accent2));color:#001;border:none;padding:8px 10px;border-radius:10px;font-weight:700;cursor:pointer;}
  .minBtn{background:transparent;border:none;color:var(--muted);font-size:18px;cursor:pointer;}
  /* chat */
  .chatWindow{max-height:320px;overflow:auto;margin-top:10px;padding-right:6px;}
  .chatRow{display:flex;gap:8px;margin-bottom:8px;}
  .chatRow.user{justify-content:flex-end;}
  .bubble{padding:10px 12px;border-radius:12px;display:inline-block;max-width:86%;}
  .bubble.user{background:linear-gradient(90deg,#ffd6e8,#ff9bd6);color:#2a0a1e;border-bottom-right-radius:4px;}
  .bubble.assistant{background:rgba(255,255,255,0.03);color:#e6f8ff;border-bottom-left-radius:4px;border:1px solid rgba(255,255,255,0.02);}
  .inputRow{display:flex;gap:8px;margin-top:8px;align-items:center;}
  .textIn{flex:1;padding:10px;border-radius:10px;background:rgba(255,255,255,0.02);border:1px solid rgba(255,255,255,0.03);color:inherit;min-height:44px;resize:none;font-size:14px;}
  .mediaPreview{margin-top:10px;border-radius:10px;overflow:hidden;max-height:320px;background:rgba(0,0,0,0.25);display:flex;align-items:center;justify-content:center;}
  .explainTip{font-size:13px;color:var(--muted);margin-top:6px;}
  footer{margin-top:14px;color:var(--muted);text-align:center;font-size:13px;}
  .toast{position:fixed;left:50%;bottom:18px;transform:translateX(-50%);background:rgba(0,0,0,0.6);padding:10px 14px;border-radius:999px;color:#fff;font-size:14px;z-index:9999;opacity:0;transition:opacity .2s;}
  .card.minimized{height:56px;overflow:hidden;padding:8px;cursor:pointer;}
</style>
</head>
<body>
<div class="wrap">
  <header>
    <div class="brand">
      <div class="logo">❤</div>
      <div>
        <h1>Priyanka — आपका Private Assistant</h1>
        <div class="subtitle">Secure • Love theme • Tap-to-explain</div>
      </div>
    </div>
    <div>
      <button class="iconBtn" id="voiceGuide" data-explain="Guide सुनने के लिए दबाएँ. यह वेबसाइट सिर्फ आपके लिए बनाई गई है। आपकी सुरक्षा और निजी जानकारियों को ध्यान में रखते हुए, यह एक लोकल एआई मॉडल है जिसे एडमिन ने डिजाइन किया है। आपकी गोपनीयता सुरक्षित है।">Guide</button>
    </div>
  </header>

  <!-- LOCK CARD (always first) -->
  <div id="lockCard" class="card">
    <div class="cardHeader">
      <div class="title"><strong>साइट लॉक</strong><div class="muted" style="font-size:12px;margin-left:8px;"> कृप्या सही पासवर्ड डालें, पासवर्ड डालने पर ही अंदर जा सकते हैं</div></div>
      <div class="controls">
        <button class="btn" id="lockInfo" data-explain="पासवर्ड बदलने के लिए index.html में ADMIN_PASSWORD बदलिए।">Info</button>
      </div>
    </div>
    <div style="margin-top:10px;">
      <input id="unlockInput" class="textIn" placeholder="पासवर्ड लिखें..." type="password" aria-label="unlock">
      <div style="display:flex;gap:8px;margin-top:8px;">
        <button class="iconBtn" id="unlockBtn" data-explain="Unlock करने के लिए दबाएँ">Unlock</button>
      </div>
      <div class="explainTip">टिप: पासवर्ड बदलने के लिए index.html में `ADMIN_PASSWORD` बदलें।</div>
    </div>
  </div>

  <!-- MAIN GRID (hidden until unlock) -->
  <div id="mainGrid" style="display:none;">
    <div class="grid">
      <!-- Admin Panel (READ-ONLY, code-only editable) -->
      <section id="adminPanel" class="card">
        <div class="cardHeader">
          <div class="title">
            <div style="width:38px;height:38px;border-radius:10px;background:linear-gradient(90deg,var(--accent1),var(--accent2));display:flex;align-items:center;justify-content:center;font-weight:700;">A</div>
            <div>
              <h2>Admin Message (Read-only)</h2>
              <div class="muted">Admin messages are defined inside the code (readonly). हर दिन एक नया संदेश दिखेगा।</div>
            </div>
          </div>
          <div class="controls">
            <button class="minBtn" data-toggle="admin">–</button>
          </div>
        </div>

        <div id="adminBody" style="margin-top:10px;">
          <div id="adminMessage" style="font-size:15px;color:#ffe8f8;line-height:1.4;">Loading admin message...</div>
          <div id="adminTime" class="muted" style="margin-top:8px;"></div>
          <div class="explainTip" style="margin-top:10px;">Admin messages केवल कोड में बदलें — UI पर edit का ऑप्शन नहीं है।</div>
        </div>
      </section>

      <!-- User Chat -->
      <section id="userPanel" class="card">
        <div class="cardHeader">
          <div class="title">
            <div style="width:38px;height:38px;border-radius:10px;background:linear-gradient(90deg,var(--accent3),#60ffd3);display:flex;align-items:center;justify-content:center;font-weight:700;">U</div>
            <div>
              <h2>User Chat</h2>
              <div class="muted">User messages saved locally • Assistant replies lovingly</div>
            </div>
          </div>
          <div class="controls">
            <button class="minBtn" data-toggle="user">–</button>
            <button class="btn" id="clearChatBtn" data-explain="Chat साफ़ करने के लिए">Clear</button>
          </div>
        </div>

        <div id="userBody" style="margin-top:10px;">
          <div id="chatWindow" class="chatWindow" aria-live="polite"></div>

          <div class="inputRow">
            <textarea id="userInput" class="textIn" placeholder="अपना संदेश लिखें — user❤️"></textarea>
            <button class="iconBtn" id="sendUser" data-explain="Send करें">❤</button>
          </div>

          <div style="display:flex;gap:8px;margin-top:8px;">
            <button class="btn" id="downloadUser" data-explain="Local saved messages डाउनलोड करें">Download</button>
            <button class="btn" id="showSavedBtn" data-explain="Saved messages दिखाएँ">Saved</button>
          </div>

          <div id="savedArea" style="margin-top:8px;"></div>
        </div>
      </section>

      <!-- Media Panel -->
      <section id="mediaPanel" class="card">
        <div class="cardHeader">
          <div class="title">
            <div style="width:38px;height:38px;border-radius:10px;background:linear-gradient(90deg,var(--accent2),var(--accent1));display:flex;align-items:center;justify-content:center;font-weight:700;">M</div>
            <div>
              <h2>Media & Content</h2>
              <div class="muted">Photo / Video / Audio preview • URL डालें और Load करें</div>
            </div>
          </div>
          <div class="controls">
            <button class="minBtn" data-toggle="media">–</button>
          </div>
        </div>

        <div id="mediaBody" style="margin-top:10px;">
          <div style="display:flex;gap:8px;flex-wrap:wrap;">
            <input id="mediaUrl" class="textIn" placeholder="Photo/Video/Audio URL डालें (youtube, mp4, mp3, jpg...)" style="flex:1;">
            <button class="btn" id="loadMediaBtn" data-explain="URL डालकर Load दबाएँ">Load</button>
          </div>

          <div style="display:flex;gap:8px;margin-top:8px;">
            <button class="btn" id="playAudioBtn">Play audio</button>
            <button class="btn" id="playVideoBtn">Play video</button>
            <button class="btn" id="showPhotoBtn">Show photo</button>
          </div>

          <div id="mediaPreview" class="mediaPreview">
            <div class="muted">No media loaded.</div>
          </div>
        </div>
      </section>
    </div>

    <footer>Built for you • Admin messages code-only • Tap any item with "Guide" to hear explanation</footer>
  </div>

  <div id="toast" class="toast"></div>
</div>

<script>
/* =========================
   CONFIGURATION (EDIT HERE)
   ========================= */

/* Lock password — change here to update site password.
   This is the single place to change password (edit index.html on GitHub). */
const ADMIN_PASSWORD = "DTYPL5133"; // ← change this value in code to update password

/* Admin messages (code-only): keep array of messages.
   System will pick a message daily (based on date) — daily rotation.
   You can add as many messages as you want. These are read-only in UI. */
const ADMIN_MESSAGES = [
  "नमस्ते — Priyanka में आपका स्वागत है! ❤️",
  "आज का संदेश: खुद पर भरोसा रखो, सब अच्छा होगा।",
  "मधुर शब्द बाँटो, प्यार पाओ।",
  "छोटे छोटे कदम बड़े बदलाव लाते हैं।",
  "आज एक मुस्कान किसी का दिन बना सकती है — मुस्कुराओ! ❤️",
  "सिकंदर बनो पर दिल नरम रखो।",
  "हर दिन एक नया मौका है — कुछ अच्छा करें।"
];

/* Optional: custom date-specific overrides (YYYY-MM-DD -> message index)
   If you want a specific message for a date, add here:
   "2025-12-25": 3   // will pick ADMIN_MESSAGES[3]
*/
const ADMIN_DATE_OVERRIDES = {
  // "2025-12-25": 4
};

/* =========================
   Helpers: TTS, toast, explain
   ========================= */
function speak(text){
  if(!('speechSynthesis' in window)) return;
  try{
    speechSynthesis.cancel();
    const u = new SpeechSynthesisUtterance(String(text));
    // prefer Hindi voice if available
    const voices = speechSynthesis.getVoices();
    let v = voices.find(v=>/hi|hindi/i.test(v.lang)) || voices.find(v=>/en/i.test(v.lang)) || voices[0];
    if(v) u.voice = v;
    u.lang = v?.lang || 'hi-IN';
    u.rate = 0.8; // धीमी गति (पहले 1 था)
    u.pitch = 1.0; // सामान्य पिच
    u.volume = 1.0; // पूरी आवाज
    speechSynthesis.speak(u);
  }catch(e){ console.warn(e); }
}
function showToast(msg){
  const t = document.getElementById('toast');
  t.textContent = msg;
  t.style.opacity = '1';
  clearTimeout(t._tm);
  t._tm = setTimeout(()=> t.style.opacity = '0', 3000);
}

/* Tap-to-explain: data-explain attribute */
document.addEventListener('click', function(ev){
  const el = ev.target.closest('[data-explain]');
  if(el){
    const txt = el.getAttribute('data-explain');
    if(txt){ speak(txt); showToast(txt); }
  }
});

/* =========================
   Lock behavior
   ========================= */
const lockCard = document.getElementById('lockCard');
const unlockInput = document.getElementById('unlockInput');
const unlockBtn = document.getElementById('unlockBtn');
const mainGrid = document.getElementById('mainGrid');

unlockBtn.addEventListener('click', ()=> attemptUnlock(unlockInput.value.trim()));

// Enter key support for password input
unlockInput.addEventListener('keypress', (e)=> {
  if(e.key === 'Enter') attemptUnlock(unlockInput.value.trim());
});

function attemptUnlock(val){
  if(!val){ 
    speak("कृपया पासवर्ड भरें"); 
    showToast("Password required"); 
    unlockInput.focus();
    return; 
  }
  if(val === ADMIN_PASSWORD){
    speak("स्वागत है, साइट खुल रही है। यह साइट विशेष लोगों के लिए है।");
    lockCard.style.display = 'none';
    mainGrid.style.display = 'block';
    // show today's admin message
    displayDailyAdmin();
  } else {
    speak("गलत पासवर्ड, कृपया पुनः प्रयास करें");
    showToast("Wrong password");
    unlockInput.value = '';
    unlockInput.focus();
    lockCard.animate([{transform:'translateX(-6px)'},{transform:'translateX(6px)'},{transform:'translateX(0)'}], {duration:380});
  }
}

/* =========================
   Admin daily message logic (code-only)
   ========================= */
function getDailyAdminIndex(){
  const today = new Date();
  const y = today.getFullYear();
  const m = (today.getMonth()+1).toString().padStart(2,'0');
  const d = today.getDate().toString().padStart(2,'0');
  const dateKey = `${y}-${m}-${d}`;
  // override?
  if(ADMIN_DATE_OVERRIDES[dateKey] !== undefined){
    return ADMIN_DATE_OVERRIDES[dateKey] % ADMIN_MESSAGES.length;
  }
  // deterministic rotation: use numeric date to pick index
  const numeric = Number(`${y}${m}${d}`);
  return numeric % ADMIN_MESSAGES.length;
}
function displayDailyAdmin(){
  const idx = getDailyAdminIndex();
  const msg = ADMIN_MESSAGES[idx] || "कोई संदेश उपलब्ध नहीं।";
  const el = document.getElementById('adminMessage');
  const meta = document.getElementById('adminTime');
  el.textContent = msg;
  meta.textContent = new Date().toLocaleString('hi-IN', {
    day: 'numeric',
    month: 'long',
    year: 'numeric',
    hour: '2-digit',
    minute: '2-digit'
  });
  // speak once when opened
  setTimeout(() => speak("Admin संदेश: " + msg), 1000);
}

/* =========================
   Minimize toggles
   ========================= */
document.querySelectorAll('.minBtn').forEach(btn=>{
  btn.addEventListener('click', ()=>{
    const t = btn.getAttribute('data-toggle'); // admin | user | media
    const panel = document.getElementById(t + 'Panel');
    // simpler: toggle .minimized on section
    if(panel.classList.contains('minimized')){
      panel.classList.remove('minimized');
      btn.textContent = '–';
    } else {
      panel.classList.add('minimized');
      btn.textContent = '+';
    }
  });
});

/* =========================
   Chat: user messages (localStorage)
   ========================= */
const chatWindow = document.getElementById('chatWindow');
const userInput = document.getElementById('userInput');
const sendUser = document.getElementById('sendUser');
const savedArea = document.getElementById('savedArea');

function getUserMsgs(){ return JSON.parse(localStorage.getItem('priyanka_user_v2')||'[]'); }
function saveUserMsgs(arr){ localStorage.setItem('priyanka_user_v2', JSON.stringify(arr)); }
function renderSaved(){ 
  const arr = getUserMsgs();
  if(arr.length===0) savedArea.innerHTML = "<div class='muted'>No saved messages.</div>";
  else savedArea.innerHTML = arr.map(m=>`<div style="padding:8px;border-radius:8px;background:rgba(255,255,255,0.02);margin-bottom:8px;">
    <div style="font-size:14px">${escapeHtml(m.text)}</div>
    <div class="muted">${m.time}</div>
  </div>`).join('');
}
function addChat(who,text){
  const row = document.createElement('div');
  row.className = 'chatRow ' + (who==='user'? 'user':'assistant');
  const b = document.createElement('div'); b.className = 'bubble ' + (who==='user'? 'user':'assistant'); b.innerText = text;
  row.appendChild(b); chatWindow.appendChild(row);
  chatWindow.scrollTop = chatWindow.scrollHeight;
}
function escapeHtml(s){ return String(s).replaceAll('<','&lt;').replaceAll('>','&gt;'); }

function assistantReply(userText){
  const t = userText.toLowerCase();
  if(t.includes('hello')||t.includes('hi')||t.includes('namaste')) return "हैलो! मैं आपकी कैसे मदद करूँ? ❤️";
  if(t.includes('pyar')||t.includes('love')||t.includes('❤️')) return "आप बेहद खास हो — मैं हमेशा साथ हूँ ❤️";
  if(t.includes('photo')) return "Media में photo URL डालकर Show photo दबाएँ।";
  if(t.includes('video')) return "Media में video URL डालकर Play video दबाएँ।";
  if(t.includes('thanks')||t.includes('thank you')||t.includes('dhanyavad')) return "आपका स्वागत है! हमेशा आपकी सेवा में ❤️";
  return "मैंने आपकी बात सुनी: \""+ userText + "\" — बताइए और क्या चाहिए?";
}

sendUser.addEventListener('click', ()=>{
  const txt = userInput.value.trim();
  if(!txt){ speak("कृपया संदेश लिखें"); showToast("Enter a message"); userInput.focus(); return; }
  addChat('user', txt);
  // save
  const arr = getUserMsgs(); arr.push({text:txt, time:new Date().toLocaleString('hi-IN')}); saveUserMsgs(arr);
  renderSaved();
  // assistant reply
  const reply = assistantReply(txt);
  setTimeout(()=>{ addChat('assistant', reply); speak(reply); }, 600);
  userInput.value = '';
  userInput.focus();
});

// Enter key support for chat
userInput.addEventListener('keypress', (e)=> {
  if(e.key === 'Enter' && !e.shiftKey) {
    e.preventDefault();
    sendUser.click();
  }
});

document.getElementById('clearChatBtn').addEventListener('click', ()=>{ 
  chatWindow.innerHTML=''; 
  speak("Chat साफ़ हो गया"); 
  showToast("Chat cleared");
});
document.getElementById('downloadUser').addEventListener('click', ()=>{
  const data = JSON.stringify(getUserMsgs(), null, 2);
  const blob = new Blob([data], {type:'application/json'});
  const url = URL.createObjectURL(blob); 
  const a=document.createElement('a'); 
  a.href=url; 
  a.download='user-messages.json'; 
  a.click(); 
  URL.revokeObjectURL(url);
  speak("Saved messages डाउनलोड हो रहे हैं");
  showToast("Messages downloaded");
});
document.getElementById('showSavedBtn').addEventListener('click', ()=>{ 
  renderSaved(); 
  speak("Saved messages दिखाए जा रहे हैं");
  showToast("Saved messages shown"); 
});

renderSaved();

/* =========================
   Media loading
   ========================= */
const mediaPreview = document.getElementById('mediaPreview');
document.getElementById('loadMediaBtn').addEventListener('click', ()=>{
  const url = document.getElementById('mediaUrl').value.trim();
  if(!url){ speak("कृपया media url डालें"); showToast("Enter URL"); return; }
  loadMedia(url);
});

function loadMedia(url){
  if(/youtube\.com|youtu\.be/.test(url)){
    let id=''; 
    if(url.includes('youtu.be/')) id = url.split('youtu.be/')[1].split(/[?&]/)[0]; 
    else if(url.includes('v=')) id = url.split('v=')[1].split('&')[0];
    if(id){ 
      mediaPreview.innerHTML = `<iframe width="100%" height="260" src="https://www.youtube.com/embed/${id}" frameborder="0" allowfullscreen></iframe>`; 
      speak("YouTube video लोड हो गया"); 
      showToast("YouTube loaded");
      return; 
    }
  }
  if(/\.mp4|\.webm|\.ogg/i.test(url)){ 
    mediaPreview.innerHTML = `<video controls style="width:100%;max-height:320px;" src="${url}"></video>`; 
    speak("Video लोड हो गया"); 
    showToast("Video loaded");
    return; 
  }
  if(/\.mp3|\.wav|\.m4a|audio/i.test(url)){ 
    mediaPreview.innerHTML = `<audio controls style="width:100%;" src="${url}"></audio>`; 
    speak("Audio लोड हो गया"); 
    showToast("Audio loaded");
    return; 
  }
  if(/\.jpg|\.jpeg|\.png|\.gif|\.svg/i.test(url)){ 
    mediaPreview.innerHTML = `<img src="${url}" style="width:100%;height:auto;display:block;max-height:320px;">`; 
    speak("Image लोड हो गया"); 
    showToast("Image loaded");
    return; 
  }
  mediaPreview.innerHTML = `<div style="padding:12px;">Preview not supported. <a href="${url}" target="_blank">Open link</a></div>`; 
  speak("Link लोड हो गया");
  showToast("Link loaded");
}

document.getElementById('playAudioBtn').addEventListener('click', ()=>{ 
  const el=mediaPreview.querySelector('audio'); 
  if(el){ 
    el.play(); 
    speak("Audio चल रहा है"); 
    showToast("Audio playing");
  } else { 
    speak("No audio loaded"); 
    showToast("No audio to play");
  }
});
document.getElementById('playVideoBtn').addEventListener('click', ()=>{ 
  const el=mediaPreview.querySelector('video'); 
  if(el){ 
    el.play(); 
    speak("Video चल रहा है"); 
    showToast("Video playing");
  } else { 
    speak("No video loaded"); 
    showToast("No video to play");
  }
});
document.getElementById('showPhotoBtn').addEventListener('click', ()=>{ 
  const el=mediaPreview.querySelector('img'); 
  if(el) {
    speak("Photo preview दिख रहा है"); 
    showToast("Photo preview");
  } else {
    speak("No image loaded"); 
    showToast("No image to show");
  }
});

/* Voice guide */
document.getElementById('voiceGuide').addEventListener('click', ()=>{
  const guide = "यह Priyanka assistant है। सबसे पहले लॉक खुलना चाहिए। Admin Message readonly है और हर दिन का संदेश दिखेगा। User Chat में message भेजें और ❤ दबाएँ। Media box में URL डालकर Load करें।";
  speak(guide); 
  showToast("Guide चलाया गया");
});

/* prefetch voices */
if('speechSynthesis' in window){ 
  speechSynthesis.onvoiceschanged = ()=>{}; 
}

/* Auto-focus on password input when page loads */
document.addEventListener('DOMContentLoaded', ()=> {
  unlockInput.focus();
  // Initialize voices for TTS
  if('speechSynthesis' in window) {
    setTimeout(() => {
      const voices = speechSynthesis.getVoices();
      if(voices.length > 0) {
        console.log("TTS voices loaded:", voices.length);
      }
    }, 1000);
  }
});

</script>
</body>
</html>
